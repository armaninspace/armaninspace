<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.26" />


<title>Notes on the Hypergeometric distribution - Arman Anwar -- Lost in Space</title>
<meta property="og:title" content="Notes on the Hypergeometric distribution - Arman Anwar -- Lost in Space">



  







<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo.png"
         width="50"
         height="50"
         alt="Arman Anwar">
  </a>

  <ul class="nav-links">
    
    <li><a href="/">About</a></li>
    
    <li><a href="https://github.com/armaninspace">GitHub</a></li>
    
    <li><a href="https://www.linkedin.com/in/arman-anwar-a107961/">LinkedIn</a></li>
    
    <li><a href="/post">RandomStuff</a></li>
    
    <li><a href="https://twitter.com/armaninspace">Twitter</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">2 min read</span>
    

    <h1 class="article-title">Notes on the Hypergeometric distribution</h1>

    

    <div class="article-content">
      <p>In contrast to binomial distribution where the probability of a success is the same for each experiment, the hypergeometric distribution describes situation when the probability of success decreases after each success (and increases after each failure). Each experiment is modelled by an urn containing <span class="math inline">\(N\)</span> balls, <span class="math inline">\(K\)</span> of them being ``lucky’’ (and <span class="math inline">\(N-K\)</span> unlucky). <span class="math inline">\(n\)</span> draws are performed from an urn and the hypergeometric random variable <span class="math inline">\(X\)</span> is the numebr of lucky balls drawn. So, each lcuky ball decreases the probability to pick a lucky ball in the next draw. One more point of view is that the hypergeometric distribution models draws without replacement, while binomial models draws with replacement (to keep the probability of picking a lucky ball constant we return the drawn ball back to the urn).</p>
<p>Parameters: <span class="math inline">\(N\)</span> – number of balls in the urn, <span class="math inline">\(K\)</span> – number of lucky balls in the urn, <span class="math inline">\(n\)</span> – number of draws, <span class="math inline">\(0\leq n\leq N,\)</span> <span class="math inline">\(0\leq K\leq N.\)</span></p>
<p>Values: <span class="math inline">\(\{0,1,2,\ldots,n\}\)</span> (in fact values with nonzero probabilities are <span class="math inline">\(k\in[\max(0,n-N+K),\min(n,K)]\)</span>)</p>
<p>Probability mass function: <span class="math display">\[
P(X=k)=\frac{{K\choose k}{N-K\choose n-k}}{{N\choose n}}, \ k=0,1,2,\ldots,n.
\]</span> (we agree that <span class="math inline">\({K\choose k}=0\)</span> for <span class="math inline">\(k&gt;K\)</span>).</p>
<p>{} There are <span class="math inline">\({N\choose n}\)</span> possibilities to draw <span class="math inline">\(n\)</span> balls from an urn containing <span class="math inline">\(N\)</span> balls. We are interested in draws that contain exactly <span class="math inline">\(k\)</span> lucky balls. So, satisfactory outcomes are draws that contain <span class="math inline">\(k\)</span> lucky and <span class="math inline">\(n-k\)</span> unlucky balls. There are <span class="math inline">\({K\choose k}{N-K\choose n-k}\)</span> possibilities to perform such draw.</p>
<p>Moment generating function does not have a simple representation: <span class="math display">\[
M(t)=\sum^{n}_{k=0}e^{tk}\frac{{K\choose k}{N-K\choose n-k}}{{N\choose n}}
\]</span></p>
<p>Expectation: <span class="math inline">\(EX=n\frac{K}{N}\)</span></p>
<p>Variance: <span class="math inline">\(V(X)=\frac{nK(N-k)(N-n)}{N^2(N-1)}\)</span></p>
<div id="derivation" class="section level3">
<h3>Derivation</h3>
<p>We find expectation as a sum over all possible values of <span class="math inline">\(X:\)</span> <span class="math display">\[
EX=\sum^n_{k=0}k \frac{{K\choose k}{N-K\choose n-k}}{{N\choose n}}=
\]</span> the summand with <span class="math inline">\(k=0\)</span> is zero <span class="math display">\[
=\frac{1}{{N\choose n}}\sum^n_{k=1}k {K\choose k}{N-K\choose n-k}=
\]</span> use the identity <span class="math inline">\(k{K\choose k}=K{K-1 \choose k-1}\)</span> <span class="math display">\[
=\frac{K}{{N\choose n}}\sum^n_{k=1} {K-1 \choose k-1 }{(N-1)-(K-1)\choose (n-1)-(k-1)}=
\]</span> change summation variable to <span class="math inline">\(k-1\)</span> <span class="math display">\[
=\frac{K}{{N\choose n}}\sum^{n-1}_{k=0} {K-1 \choose k }{(N-1)-(K-1)\choose (n-1)-k}=
\]</span> represent the sum as a sum of all probabilities for hypergeometric distribution with parameters <span class="math inline">\(N-1,K-1,n-1\)</span> (which is 1) <span class="math display">\[
=\frac{K{N-1\choose n-1}}{{N\choose n}}\sum^{n-1}_{k=0} \frac{{K-1 \choose k }{(N-1)-(K-1)\choose (n-1)-k}}{{N-1\choose n-1}}=\frac{K{N-1\choose n-1}}{{N\choose n}}=n\frac{K}{N}
\]</span></p>
<p>Similarly we find <span class="math inline">\(EX(X-1):\)</span> <span class="math display">\[
EX(X-1)=\sum^n_{k=0} k(k-1)\frac{{K\choose k}{N-K\choose n-k}}{{N\choose n}}=
\]</span> <span class="math display">\[
=\frac{1}{{N\choose n}}\sum^n_{k=2}k(k-1) {K\choose k}{N-K\choose n-k}=
\]</span> use the identity <span class="math inline">\(k(k-1){K\choose k}=K(K-1){K-2 \choose k-2}\)</span> <span class="math display">\[
=\frac{K(K-1)}{{N\choose n}}\sum^{n-2}_{k=0} {K-2 \choose k }{(N-2)-(K-2)\choose (n-2)-k}=
\]</span> <span class="math display">\[
=\frac{K(K-1){N-2\choose n-2}}{{N\choose n}}=n(n-1)\frac{K(K-1)}{N(N-1)}
\]</span></p>
<p>Variance is <span class="math display">\[
V(X)=EX^2-(EX)^2=EX(X-1)+EX-(EX)^2=\]</span> <span class="math display">\[
=n(n-1)\frac{K(K-1)}{N(N-1)}+n\frac{K}{N}-n^2\frac{K^2}{N^2}=
\]</span> <span class="math display">\[
=\frac{nKN^2-n^2KN-nK^2N+n^2K^2}{N^2(N-1)}=\frac{nK(N-k)(N-n)}{N^2(N-1)}
\]</span></p>
</div>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            &copy; Arman Anwar 2000 -- Today
          </li>
          
        </ul>
      </footer>

    </div>
    

    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

